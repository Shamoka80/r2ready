You are the Replit AI Engineer. Apply the following plan end-to-end. Make permanent, minimal, and reversible changes. Work in a feature branch. Show diffs for every file you edit. Stop on errors and print the failing command output.

========================================
0) PROJECT ASSUMPTIONS
- Monorepo with ./client and ./server
- TypeScript on both sides
- Drizzle ORM with Postgres/Neon
- ESLint + Vite on client, ts-node/tsx on server

If any path differs, detect automatically and adapt while keeping the intent of each step.

========================================
1) CREATE BRANCH AND SNAPSHOT
- Run:
  git init || true
  git add -A
  git commit -m "snapshot before harden" || true
  git checkout -b fix/system-harden
- Ensure a clean working tree before edits.

========================================
2) KILL DUPLICATE REACT COMPONENTS (BUILD-BREAKER)
Goal: Each file exports exactly ONE default component and zero duplicate component declarations. Keep the component whose name matches the file stem. Remove or fold others into helpers.

Files to fix:
- client/src/pages/Register.tsx
- client/src/pages/Login.tsx
- client/src/pages/tabs/AnalyticsTab.tsx
- client/src/pages/tabs/EvidenceTab.tsx

Mechanics:
- For each file:
  - If multiple React components with identical or competing names exist, KEEP the component whose name == filename stem (e.g., Register for Register.tsx). Remove the other duplicates.
  - Ensure exactly one `export default <ComponentName>` per file.
  - Convert any second componentâ€™s useful logic into named helper functions inside the same file only if referenced. Otherwise delete.
  - Remove unused imports and variables.
  - Fix imports so hooks/context come from the canonical sources:
    - useAuth, AuthProvider from client/src/context/AuthContext.tsx
    - ProtectedRoute from client/src/routes/ProtectedRoute.tsx
  - Ensure each file compiles in isolation: add missing prop types or interfaces as needed.
- After editing each file, run: npx tsc -p client --noEmit to confirm TypeScript passes for the client folder, then continue.
- Do not introduce new props unless necessary for compilation.

Validation:
- `rg -n "export default" client/src | awk -F: '{print $1}' | sort | uniq -c` must show exactly one default export per file edited.
- `npx tsc -p client --noEmit` must complete with 0 errors.

========================================
3) DRIZZLE ORM TYPE MISMATCH FIX (874 TS ERRORS)
Root cause: drift between workspace Drizzle version and server node_modules.

Hard-pin versions on server and root to match workspace:
- In server/package.json AND in root package.json (if Drizzle also referenced there), set:
  "drizzle-orm": "0.39.1",
  "drizzle-kit": "0.26.2"
- Ensure Postgres driver compatibility:
  Add or align:
  "postgres": "^3.4.5",
  "@neondatabase/serverless": "^0.10.0"
(If any of these already exist, update to these ranges. Do NOT upgrade drizzle-orm beyond 0.39.1.)

Clean installs:
- Run at repo root:
  rm -rf node_modules package-lock.json
  [ -d server ] && (cd server && rm -rf node_modules package-lock.json)
  npm install --legacy-peer-deps
  [ -d server ] && (cd server && npm install --legacy-peer-deps)

Type configs:
- Create tsconfig.base.json at repo root:

{
  "compilerOptions": {
    "target": "ES2022",
    "lib": ["ES2022", "DOM"],
    "module": "ESNext",
    "moduleResolution": "Bundler",
    "strict": true,
    "noUncheckedIndexedAccess": true,
    "noImplicitOverride": true,
    "noFallthroughCasesInSwitch": true,
    "useUnknownInCatchVariables": true,
    "resolveJsonModule": true,
    "skipLibCheck": true,
    "baseUrl": ".",
    "paths": { "@/*": ["client/src/*"] }
  }
}

- Ensure client/tsconfig.json extends the base and includes Vite types:

{
  "exte
